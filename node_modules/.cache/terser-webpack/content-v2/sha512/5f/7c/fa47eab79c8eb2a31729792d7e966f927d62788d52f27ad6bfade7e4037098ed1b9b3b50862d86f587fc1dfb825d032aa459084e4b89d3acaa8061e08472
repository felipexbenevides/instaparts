{"map":{"version":3,"sources":["97-es2015.7248384c4b0e3ebc53ee.js"],"names":["window","push","8Mb5","module","__webpack_exports__","__webpack_require__","r","d","VirtualScroll","_index_e23c3ffd_js__WEBPACK_IMPORTED_MODULE_0__","createNode","el","type","template","getTemplate","ownerDocument","importNode","content","children","querySelector","calcCells","items","itemHeight","headerHeight","footerHeight","headerFn","footerFn","approxHeaderHeight","approxFooterHeight","approxItemHeight","j","offset","len","cells","end","i","item","value","index","height","reads","visible","[object Object]","hostRef","Object","this","range","length","viewportHeight","virtualDom","isEnabled","viewportOffset","currentScrollTop","indexDirty","lastItemLen","totalHeight","onScroll","updateVirtualScroll","contentEl","closest","scrollEl","getScrollElement","updateState","console","error","undefined","Promise","resolve","heightIndex","cell","find","c","positionForIndex","getHeightIndex","cellIndex","findIndex","findCellIndex","dst","src","inplaceUpdate","Math","max","scheduleUpdate","checkRange","timerUpdate","clearTimeout","readVS","bind","writeVS","topOffset","node","offsetTop","parentElement","offsetHeight","scrollTop","dirtyIndex","viewport","vierportHeight","top","bottom","buffer","topPos","bottomPos","min","getRange","currentRange","getShouldUpdate","dom","change","toMutate","n","pool","filter","forEach","updateVDom","nodeRender","updateCellHeight","Array","from","tagName","childrenNu","child","newChild","classList","add","appendChild","style","transform","remove","doRender","domRender","renderItem","update","getComputedStyle","parseFloat","getPropertyValue","setCellHeight","componentOnReady","then","setTimeout","shouldEnable","enableScrollEvents","Infinity","calcHeightIndex","buf","Uint32Array","newBuf","set","subarray","resizeBuffer","acum","shouldListen","rmEvent","addEventListener","removeEventListener","renderHeader","renderFooter","VirtualProxy","map","renderVirtualNode","watchers","utils","vattrs","classes","class","assign"],"mappings":"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"},"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[97],{\"8Mb5\":function(module,__webpack_exports__,__webpack_require__){\"use strict\";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,\"ion_virtual_scroll\",(function(){return VirtualScroll}));var _index_e23c3ffd_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(\"+9FH\");const createNode=(el,type)=>{const template=getTemplate(el,type);return template&&el.ownerDocument?el.ownerDocument.importNode(template.content,!0).children[0]:null},getTemplate=(el,type)=>{switch(type){case\"item\":return el.querySelector(\"template:not([name])\");case\"header\":return el.querySelector(\"template[name=header]\");case\"footer\":return el.querySelector(\"template[name=footer]\")}},calcCells=(items,itemHeight,headerHeight,footerHeight,headerFn,footerFn,approxHeaderHeight,approxFooterHeight,approxItemHeight,j,offset,len)=>{const cells=[],end=len+offset;for(let i=offset;i<end;i++){const item=items[i];if(headerFn){const value=headerFn(item,i,items);null!=value&&cells.push({i:j++,type:\"header\",value:value,index:i,height:headerHeight?headerHeight(value,i):approxHeaderHeight,reads:headerHeight?0:2,visible:!!headerHeight})}if(cells.push({i:j++,type:\"item\",value:item,index:i,height:itemHeight?itemHeight(item,i):approxItemHeight,reads:itemHeight?0:2,visible:!!itemHeight}),footerFn){const value=footerFn(item,i,items);null!=value&&cells.push({i:j++,type:\"footer\",value:value,index:i,height:footerHeight?footerHeight(value,i):approxFooterHeight,reads:footerHeight?0:2,visible:!!footerHeight})}}return cells},VirtualScroll=class{constructor(hostRef){Object(_index_e23c3ffd_js__WEBPACK_IMPORTED_MODULE_0__.l)(this,hostRef),this.range={offset:0,length:0},this.viewportHeight=0,this.cells=[],this.virtualDom=[],this.isEnabled=!1,this.viewportOffset=0,this.currentScrollTop=0,this.indexDirty=0,this.lastItemLen=0,this.totalHeight=0,this.approxItemHeight=45,this.approxHeaderHeight=30,this.approxFooterHeight=30,this.onScroll=()=>{this.updateVirtualScroll()}}itemsChanged(){this.calcCells(),this.updateVirtualScroll()}async connectedCallback(){const contentEl=this.el.closest(\"ion-content\");contentEl?(this.scrollEl=await contentEl.getScrollElement(),this.contentEl=contentEl,this.calcCells(),this.updateState()):console.error(\"<ion-virtual-scroll> must be used inside an <ion-content>\")}componentDidUpdate(){this.updateState()}disconnectedCallback(){this.scrollEl=void 0}onResize(){this.calcCells(),this.updateVirtualScroll()}positionForItem(index){return Promise.resolve(((index,cells,heightIndex)=>{const cell=cells.find(c=>\"item\"===c.type&&c.index===index);return cell?heightIndex[cell.i]:-1})(index,this.cells,this.getHeightIndex()))}async checkRange(offset,len=-1){if(!this.items)return;const length=-1===len?this.items.length-offset:len,cellIndex=((cells,index)=>0===index?0:index===(cells.length>0?cells[cells.length-1].index:0)+1?cells.length:cells.findIndex(c=>c.index===index))(this.cells,offset),cells=calcCells(this.items,this.itemHeight,this.headerHeight,this.footerHeight,this.headerFn,this.footerFn,this.approxHeaderHeight,this.approxFooterHeight,this.approxItemHeight,cellIndex,offset,length);this.cells=((dst,src,offset)=>{if(0===offset&&src.length>=dst.length)return src;for(let i=0;i<src.length;i++)dst[i+offset]=src[i];return dst})(this.cells,cells,cellIndex),this.lastItemLen=this.items.length,this.indexDirty=Math.max(offset-1,0),this.scheduleUpdate()}async checkEnd(){this.items&&this.checkRange(this.lastItemLen)}updateVirtualScroll(){this.isEnabled&&this.scrollEl&&(this.timerUpdate&&(clearTimeout(this.timerUpdate),this.timerUpdate=void 0),Object(_index_e23c3ffd_js__WEBPACK_IMPORTED_MODULE_0__.h)(this.readVS.bind(this)),Object(_index_e23c3ffd_js__WEBPACK_IMPORTED_MODULE_0__.n)(this.writeVS.bind(this)))}readVS(){const{contentEl:contentEl,scrollEl:scrollEl,el:el}=this;let topOffset=0,node=el;for(;node&&node!==contentEl;)topOffset+=node.offsetTop,node=node.parentElement;this.viewportOffset=topOffset,scrollEl&&(this.viewportHeight=scrollEl.offsetHeight,this.currentScrollTop=scrollEl.scrollTop)}writeVS(){const dirtyIndex=this.indexDirty,viewport=(scrollTop=this.currentScrollTop-this.viewportOffset,vierportHeight=this.viewportHeight,{top:Math.max(scrollTop-100,0),bottom:scrollTop+vierportHeight+100}),heightIndex=this.getHeightIndex(),range=((heightIndex,viewport,buffer)=>{const topPos=viewport.top,bottomPos=viewport.bottom;let i=0;for(;i<heightIndex.length&&!(heightIndex[i]>topPos);i++);const offset=Math.max(i-2-1,0);for(;i<heightIndex.length&&!(heightIndex[i]>=bottomPos);i++);return{offset:offset,length:Math.min(i+2,heightIndex.length)-offset}})(heightIndex,viewport);var scrollTop,vierportHeight;((dirtyIndex,currentRange,range)=>dirtyIndex<=range.offset+range.length||currentRange.offset!==range.offset||currentRange.length!==range.length)(dirtyIndex,this.range,range)&&(this.range=range,((dom,heightIndex,cells,range)=>{for(const node of dom)node.change=0,node.d=!0;const toMutate=[],end=range.offset+range.length;for(let i=range.offset;i<end;i++){const cell=cells[i],node=dom.find(n=>n.d&&n.cell===cell);if(node){const top=heightIndex[i];top!==node.top&&(node.top=top,node.change=1),node.d=!1}else toMutate.push(cell)}const pool=dom.filter(n=>n.d);for(const cell of toMutate){const node=pool.find(n=>n.d&&n.cell.type===cell.type),index=cell.i;node?(node.d=!1,node.change=2,node.cell=cell,node.top=heightIndex[index]):dom.push({d:!1,cell:cell,visible:!0,change:2,top:heightIndex[index]})}dom.filter(n=>n.d&&-9999!==n.top).forEach(n=>{n.change=1,n.top=-9999})})(this.virtualDom,heightIndex,this.cells,range),this.nodeRender?((el,nodeRender,dom,updateCellHeight)=>{const children=Array.from(el.children).filter(n=>\"TEMPLATE\"!==n.tagName),childrenNu=children.length;let child;for(let i=0;i<dom.length;i++){const node=dom[i],cell=node.cell;if(2===node.change){if(i<childrenNu)child=children[i],nodeRender(child,cell,i);else{const newChild=createNode(el,cell.type);child=nodeRender(newChild,cell,i)||newChild,child.classList.add(\"virtual-item\"),el.appendChild(child)}child.$ionCell=cell}else child=children[i];0!==node.change&&(child.style.transform=`translate3d(0,${node.top}px,0)`);const visible=cell.visible;node.visible!==visible&&(visible?child.classList.remove(\"virtual-loading\"):child.classList.add(\"virtual-loading\"),node.visible=visible),cell.reads>0&&(updateCellHeight(cell,child),cell.reads--)}})(this.el,this.nodeRender,this.virtualDom,this.updateCellHeight.bind(this)):this.domRender?this.domRender(this.virtualDom):this.renderItem&&Object(_index_e23c3ffd_js__WEBPACK_IMPORTED_MODULE_0__.k)(this))}updateCellHeight(cell,node){const update=()=>{if(node.$ionCell===cell){const style=window.getComputedStyle(node),height=node.offsetHeight+parseFloat(style.getPropertyValue(\"margin-bottom\"));this.setCellHeight(cell,height)}};node&&node.componentOnReady?node.componentOnReady().then(update):update()}setCellHeight(cell,height){const index=cell.i;cell===this.cells[index]&&(cell.height===height&&!0===cell.visible||(cell.visible=!0,cell.height=height,this.indexDirty=Math.min(this.indexDirty,index),this.scheduleUpdate()))}scheduleUpdate(){clearTimeout(this.timerUpdate),this.timerUpdate=setTimeout(()=>this.updateVirtualScroll(),100)}updateState(){const shouldEnable=!(!this.scrollEl||!this.cells);shouldEnable!==this.isEnabled&&(this.enableScrollEvents(shouldEnable),shouldEnable&&this.updateVirtualScroll())}calcCells(){this.items&&(this.lastItemLen=this.items.length,this.cells=calcCells(this.items,this.itemHeight,this.headerHeight,this.footerHeight,this.headerFn,this.footerFn,this.approxHeaderHeight,this.approxFooterHeight,this.approxItemHeight,0,0,this.lastItemLen),this.indexDirty=0)}getHeightIndex(){return this.indexDirty!==1/0&&this.calcHeightIndex(this.indexDirty),this.heightIndex}calcHeightIndex(index=0){this.heightIndex=((buf,len)=>{if(!buf)return new Uint32Array(len);if(buf.length===len)return buf;if(len>buf.length){const newBuf=new Uint32Array(len);return newBuf.set(buf),newBuf}return buf.subarray(0,len)})(this.heightIndex,this.cells.length),this.totalHeight=((buf,cells,index)=>{let acum=buf[index];for(let i=index;i<buf.length;i++)buf[i]=acum,acum+=cells[i].height;return acum})(this.heightIndex,this.cells,index),this.indexDirty=1/0}enableScrollEvents(shouldListen){this.rmEvent&&(this.rmEvent(),this.rmEvent=void 0);const scrollEl=this.scrollEl;scrollEl&&(this.isEnabled=shouldListen,scrollEl.addEventListener(\"scroll\",this.onScroll),this.rmEvent=()=>{scrollEl.removeEventListener(\"scroll\",this.onScroll)})}renderVirtualNode(node){const{type:type,value:value,index:index}=node.cell;switch(type){case\"item\":return this.renderItem(value,index);case\"header\":return this.renderHeader(value,index);case\"footer\":return this.renderFooter(value,index)}}render(){return Object(_index_e23c3ffd_js__WEBPACK_IMPORTED_MODULE_0__.j)(_index_e23c3ffd_js__WEBPACK_IMPORTED_MODULE_0__.b,{style:{height:`${this.totalHeight}px`}},this.renderItem&&Object(_index_e23c3ffd_js__WEBPACK_IMPORTED_MODULE_0__.j)(VirtualProxy,{dom:this.virtualDom},this.virtualDom.map(node=>this.renderVirtualNode(node))))}get el(){return Object(_index_e23c3ffd_js__WEBPACK_IMPORTED_MODULE_0__.g)(this)}static get watchers(){return{itemHeight:[\"itemsChanged\"],headerHeight:[\"itemsChanged\"],footerHeight:[\"itemsChanged\"],items:[\"itemsChanged\"]}}},VirtualProxy=({dom:dom},children,utils)=>utils.map(children,(child,i)=>{const node=dom[i],vattrs=child.vattrs||{};let classes=vattrs.class||\"\";return classes+=\"virtual-item \",node.visible||(classes+=\"virtual-loading\"),Object.assign(Object.assign({},child),{vattrs:Object.assign(Object.assign({},vattrs),{class:classes,style:Object.assign(Object.assign({},vattrs.style),{transform:`translate3d(0,${node.top}px,0)`})})})});VirtualScroll.style=\"ion-virtual-scroll{display:block;position:relative;width:100%;contain:strict;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}ion-virtual-scroll>.virtual-loading{opacity:0}ion-virtual-scroll>.virtual-item{position:absolute !important;top:0 !important;right:0 !important;left:0 !important;-webkit-transition-duration:0ms;transition-duration:0ms;will-change:transform}\"}}]);","extractedComments":[]}